#!/bin/zsh
source $DIR_DOTFILES/backpack/functions.sh

echo_title_install "brew cask"
if ! brew tap | grep cask > /dev/null; then
  echo_title "Tap brew cask"
  brew tap phinze/homebrew-cask
fi

brew install brew-cask 2>&1 | grep -v "already installed"

echo_title_install "native OS X Apps"

APPS=(
	# enhance OS X with some small utilities
	"xtra-finder"
	"app-cleaner"

	#	"noip_duc #todo"
	"f-lux"
	"alfred"
	"shortcat"

	# browsers
	"chrome"
	"firefox"

	# sync & download
	"dropbox"
	"bit-torrent-sync"
	"google-drive"
	"transmission"

	# multimedia
	"vlc"
	"mplayerx"
	"rdio"
	"subtitles"
	"all2mp3"

	# organization & workflow
	# todo
	#	"wunderlist"
	#	"libreoffice"

	# messengers
	"skype"
	"google-hangouts"

	"sublime-text-3"
	# todo
	#	"prey"
)

# LOCAL APPS
# todo add just for me ($USER = MoOx ?)
APPS_LOCAL=(
	"keepass-x-2"

	"lastfm"
	"firefox-aurora"
	# todo
	# "firefox-nightly"
	# "firefox-ux"

	# required by I don't know why
	"x-quartz"

	# for vpn
	"tunnelblick"

	# lazydev
	"github"
	"cyberduck"

	# just in case
	"imagealpha"
	"imageoptim"

	# more utilities
	"mou"
	"cloudapp"

	# more messengers
	"lime-chat"
	"hip-chat"

	"virtualbox"
	"versions"

	"steam"

	"trim-enabler"
	"synergy"
	"super-duper"

	"sourcetree"
	"shortcat"
	"iterm2"
	"slate"

	"jubler"

	"colors"
	"gimp"

	"integrity"
	#"sitesucker" broken package
	# todo site-sucker
	"slowy"

	"name-changer"
	"coconutbattery"
	# todo coconut-battery

	"grand-perspective"

	"logitech-control-center"
	"logitech-unifying"

	#"bodega # will I use it ?"
	#""

	"day-o"
)

# todo
#gfx-card-status http://gfx.io/downloads/gfxCardStatus-2.3.zip
#SetAPPSync
#BootChamp

# output is too ugly for now
# https://github.com/phinze/homebrew-cask/issues/1323
#cask-install-async $APPS[@]

for app in $APPS; do
	brew cask install $app --appdir="/Applications" 2>&1 | grep -v "already installed"
done

for app in $APPS_LOCAL; do
	brew cask install $app --appdir="$HOME/Applications" 2>&1 | grep -v "already installed"
done

# todo themes
#https://github.com/kud/my/blob/master/scripts/rocknroll#L135


if ! type "subl" > /dev/null; then
	echo_title "Configuring Sublime Text bin"
	ln -s /Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl /usr/local/bin/subl
fi


###
# Transmission.app
###

# Use `~/Documents/Torrents` to store incomplete downloads
defaults write org.m0k.transmission UseIncompleteDownloadFolder -bool true
defaults write org.m0k.transmission IncompleteDownloadFolder -string "${HOME}/Downloads/Torrents"

# Donâ€™t prompt for confirmation before downloading
defaults write org.m0k.transmission DownloadAsk -bool false

# Trash original torrent files
defaults write org.m0k.transmission DeleteOriginalTorrent -bool true

# Hide the donate message
defaults write org.m0k.transmission WarningDonate -bool false
# Hide the legal disclaimer
defaults write org.m0k.transmission WarningLegal -bool false

# todo add to Alfred.app search scope
# /Applications/Xcode.app/Contents/Applications/
# /System/Library/CoreServices/
# /System/Library/CoreServices/Applications/
# /opt/homebrew-cask/Caskroom/
